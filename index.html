<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Endo/Exothermic Bond Energy Simulator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
    .bar {
      height: 30px;
      border-radius: 8px;
      transition: width 0.6s ease-in-out;
    }
  </style>
</head>
<body class="text-slate-900">
  <div class="max-w-6xl mx-auto p-6 space-y-8">
    <h1 class="text-3xl font-bold text-blue-700 text-center">Endo/Exothermic Bond Energy Simulator</h1>
    <p class="text-center text-slate-600 text-sm">Use bond energies (kJ/mol) to calculate ΣE broken and ΣE formed, then determine whether the reaction is endothermic or exothermic.</p>

    <!-- Step 1: Presets -->
    <div class="bg-white rounded-2xl shadow p-4">
      <h2 class="font-semibold mb-2">Step 1 — Choose a Reaction</h2>
      <div id="preset-buttons" class="space-y-2"></div>
    </div>

    <!-- Step 2: Bond Count Inputs -->
    <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-blue-50 rounded-2xl p-4">
        <h2 class="font-semibold text-blue-700 mb-2">Step 2 — Reactants: Bonds Broken</h2>
        <div id="reactant-list" class="space-y-1 text-sm"></div>
      </div>
      <div class="bg-green-50 rounded-2xl p-4">
        <h2 class="font-semibold text-green-700 mb-2">Step 3 — Products: Bonds Formed</h2>
        <div id="product-list" class="space-y-1 text-sm"></div>
      </div>
    </div>

    <!-- Step 4: Summary -->
    <div class="grid md:grid-cols-2 gap-6">
      <div class="bg-white rounded-2xl shadow p-4">
        <h2 class="font-semibold mb-2">Step 4 — Summary</h2>
        <p id="broken-total">ΣE Broken (Reactants): 0 kJ/mol</p>
        <p id="formed-total">ΣE Formed (Products): 0 kJ/mol</p>
        <p id="delta-h">ΔH = 0 kJ/mol</p>
        <p id="reaction-type" class="mt-2 font-semibold text-blue-600">Reaction Type: —</p>
      </div>

      <!-- Step 5: Chart -->
      <div class="bg-white rounded-2xl shadow p-4">
        <h2 class="font-semibold mb-2">Step 5 — Energy Comparison Chart</h2>
        <div class="h-64 flex flex-col justify-center gap-4">
          <div>
            <div class="flex justify-between text-sm mb-1"><span>ΣE broken (reactants)</span><span id="bar-broken-value">0</span></div>
            <div class="w-full bg-slate-200"><div id="bar-broken" class="bar bg-blue-500" style="width:0%"></div></div>
          </div>
          <div>
            <div class="flex justify-between text-sm mb-1"><span>ΣE formed (products)</span><span id="bar-formed-value">0</span></div>
            <div class="w-full bg-slate-200"><div id="bar-formed" class="bar bg-green-500" style="width:0%"></div></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Step 6: Student Calculation Pad -->
    <div class="bg-white rounded-2xl shadow p-4">
      <h2 class="font-semibold mb-2">Step 6 — Student Calculation Pad</h2>
      <div class="grid md:grid-cols-3 gap-4">
        <div>
          <label class="text-xs text-slate-600">My ΣE Broken (kJ/mol)</label>
          <input id="input-broken" class="w-full border rounded px-2 py-1" />
        </div>
        <div>
          <label class="text-xs text-slate-600">My ΣE Formed (kJ/mol)</label>
          <input id="input-formed" class="w-full border rounded px-2 py-1" />
        </div>
        <div>
          <label class="text-xs text-slate-600">My ΔH</label>
          <input id="input-delta" class="w-full border rounded px-2 py-1" />
        </div>
      </div>
      <button id="check-btn" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Check My Work</button>
      <p id="feedback" class="mt-3"></p>
    </div>
  </div>

  <script>
    const bondEnergies = {
      "H-H":436,"Cl-Cl":243,"H-Cl":431,"O=O":498,"O-H":463,
      "C-H":413,"C-C":348,"C=C":614,"C=O":799,"C-O":358,
      "O-O":146,"N≡N":945,"N-H":391
    };

    const presets = [
      { id:"hcl", name:"H₂ + Cl₂ → 2 HCl", desc:"Synthesis of hydrogen chloride" },
      { id:"combustion", name:"CH₄ + 2 O₂ → CO₂ + 2 H₂O", desc:"Combustion of methane" },
      { id:"haber", name:"N₂ + 3 H₂ → 2 NH₃", desc:"Haber process" },
      { id:"water_split", name:"2 H₂O → 2 H₂ + O₂", desc:"Electrolysis of water" },
      { id:"ethanol_combustion", name:"C₂H₅OH + 3 O₂ → 2 CO₂ + 3 H₂O", desc:"Combustion of ethanol" },
    ];

    const reactantList = document.getElementById("reactant-list");
    const productList = document.getElementById("product-list");
    const brokenTotalEl = document.getElementById("broken-total");
    const formedTotalEl = document.getElementById("formed-total");
    const deltaHEl = document.getElementById("delta-h");
    const typeEl = document.getElementById("reaction-type");
    const feedbackEl = document.getElementById("feedback");

    const barBroken = document.getElementById("bar-broken");
    const barFormed = document.getElementById("bar-formed");
    const barBrokenValue = document.getElementById("bar-broken-value");
    const barFormedValue = document.getElementById("bar-formed-value");

    let reactants = {};
    let products = {};

    // Render all bonds
    function renderBondLists() {
      const createBondRow = (key, side) => {
        const wrapper = document.createElement("div");
        wrapper.className = "flex justify-between items-center border-b border-slate-200 py-1";
        const label = document.createElement("span");
        label.textContent = key;
        const controls = document.createElement("div");
        controls.className = "flex gap-2";
        const minus = document.createElement("button");
        minus.textContent = "−";
        minus.className = "border rounded px-2";
        const input = document.createElement("input");
        input.value = 0;
        input.className = "w-16 border rounded text-center";
        const plus = document.createElement("button");
        plus.textContent = "+";
        plus.className = "border rounded px-2";

        function update(v) {
          const val = Math.max(0, Number(v)||0);
          if(side==="r") reactants[key]=val; else products[key]=val;
          input.value = val;
          updateTotals();
        }

        plus.onclick = ()=>update((side==="r"?reactants[key]:products[key])+1);
        minus.onclick = ()=>update((side==="r"?reactants[key]:products[key])-1);
        input.oninput = ()=>update(input.value);
        controls.append(minus,input,plus);
        wrapper.append(label,controls);
        return wrapper;
      };

      Object.keys(bondEnergies).sort().forEach(k=>{
        reactantList.append(createBondRow(k,"r"));
        productList.append(createBondRow(k,"p"));
      });
    }

    // Compute and update display
    function updateTotals(){
      const sum = (obj)=>Object.entries(obj).reduce((s,[k,c])=>s+(bondEnergies[k]||0)*(c||0),0);
      const totalBroken = sum(reactants);
      const totalFormed = sum(products);
      const deltaH = totalBroken - totalFormed;
      const type = deltaH>0?"Endothermic":deltaH<0?"Exothermic":"Neutral";

      brokenTotalEl.textContent = `ΣE Broken (Reactants): ${totalBroken} kJ/mol`;
      formedTotalEl.textContent = `ΣE Formed (Products): ${totalFormed} kJ/mol`;
      deltaHEl.textContent = `ΔH = ${totalBroken} − ${totalFormed} = ${deltaH} kJ/mol`;
      typeEl.textContent = `Reaction Type: ${type}`;
      typeEl.className = `mt-2 font-semibold ${type==="Exothermic"?"text-green-600":"text-blue-600"}`;

      // Animate chart bars
      const maxEnergy = Math.max(totalBroken,totalFormed,1);
      barBroken.style.width = (totalBroken/maxEnergy*100)+"%";
      barFormed.style.width = (totalFormed/maxEnergy*100)+"%";
      barBrokenValue.textContent = totalBroken;
      barFormedValue.textContent = totalFormed;
    }

    // Presets
    function renderPresets(){
      const container=document.getElementById("preset-buttons");
      presets.forEach(p=>{
        const btn=document.createElement("button");
        btn.className="w-full text-left p-3 rounded-lg bg-slate-100 hover:bg-slate-200";
        btn.innerHTML=`<div class='font-medium'>${p.name}</div><div class='text-xs text-slate-600'>${p.desc}</div>`;
        btn.onclick=()=>{
          document.querySelectorAll("#preset-buttons button").forEach(b=>b.classList.remove("bg-blue-100"));
          btn.classList.add("bg-blue-100");
          // Reset counts
          reactants={}; products={};
          document.querySelectorAll("input").forEach(i=>i.value=0);
          updateTotals();
        };
        container.append(btn);
      });
    }

    // Check Work
    document.getElementById("check-btn").onclick=()=>{
      const sB=Number(document.getElementById("input-broken").value);
      const sF=Number(document.getElementById("input-formed").value);
      const sD=Number(document.getElementById("input-delta").value);
      const sum=(obj)=>Object.entries(obj).reduce((s,[k,c])=>s+(bondEnergies[k]||0)*(c||0),0);
      const totalBroken=sum(reactants);
      const totalFormed=sum(products);
      const deltaH=totalBroken-totalFormed;
      const correctB=Math.abs(sB-totalBroken)<5;
      const correctF=Math.abs(sF-totalFormed)<5;
      const correctD=Math.abs(sD-deltaH)<5;
      if(correctB&&correctF&&correctD){
        feedbackEl.textContent="✅ Great work! Your totals and ΔH look correct!";
        feedbackEl.className="mt-3 text-green-700 font-semibold";
      }else{
        feedbackEl.textContent="⚠️ Check your math — your totals differ from expected values.";
        feedbackEl.className="mt-3 text-red-600 font-semibold";
      }
    };

    // Initialize
    renderBondLists();
    renderPresets();
    updateTotals();
  </script>
</body>
</html>
