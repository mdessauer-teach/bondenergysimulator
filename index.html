<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Endo/Exothermic Bond Energy Simulator</title>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { font-family: 'Inter', sans-serif; background:#f8fafc; }
    .bar { height:30px; border-radius:8px; transition:width .6s ease-in-out; }
    .bond-line { stroke-width:3; transition:opacity .5s ease; cursor:pointer; }
    .bond-line.hidden { opacity:0.1; }
    .bond-input { width:60px; text-align:center; border:1px solid #cbd5e1;
      border-radius:4px; font-size:.8rem; padding:2px; }
    .invalid { border-color:#f59e0b; box-shadow:0 0 3px #fbbf24; }
    .modal-bg { position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,.4); display:flex; align-items:center; justify-content:center; }
  </style>
</head>

<body class="text-slate-900">
  <div class="max-w-6xl mx-auto p-6 space-y-8">
    <h1 class="text-3xl font-bold text-blue-700 text-center">
      Endo/Exothermic Bond Energy Simulator
    </h1>
    <p class="text-center text-slate-600 text-sm">
      Use bond energies (kJ/mol) to calculate ΣE broken and ΣE formed, then determine whether the reaction is endothermic or exothermic.
    </p>

    <!-- Step 1 -->
    <div class="bg-white rounded-2xl shadow p-4">
      <h2 class="font-semibold mb-2">Step 1 — Choose a Reaction</h2>
      <div id="preset-buttons" class="space-y-2"></div>
    </div>

    <!-- Step 2 -->
    <div id="molecule-panel" class="bg-white rounded-2xl shadow p-4 hidden">
      <h2 class="font-semibold mb-4">Step 2 — Model Breaking and Forming Bonds</h2>
      <!-- bigger, boxed, scrollable if needed -->
      <div
        id="svg-container"
        class="flex justify-center bg-slate-50 rounded-xl border border-slate-200 p-4 overflow-x-auto min-h-[260px]"
      ></div>
      <div class="flex justify-center gap-4 mt-4">
        <button id="break-btn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Break Bonds</button>
        <button id="form-btn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">Form Bonds</button>
        <button id="reset-btn" class="bg-slate-500 text-white px-4 py-2 rounded hover:bg-slate-600">Reset Reaction</button>
      </div>
    </div>

    <!-- Step 3 -->
    <div id="summary" class="bg-white rounded-2xl shadow p-4 hidden">
      <h2 class="font-semibold mb-2">Step 3 — Energy Summary</h2>
      <div class="h-64 flex flex-col justify-center gap-4">
        <div>
          <div class="flex justify-between text-sm mb-1"><span>ΣE broken (reactants)</span><span id="bar-broken-value">0</span></div>
          <div class="w-full bg-slate-200"><div id="bar-broken" class="bar bg-blue-600" style="width:0%"></div></div>
        </div>
        <div>
          <div class="flex justify-between text-sm mb-1"><span>ΣE formed (products)</span><span id="bar-formed-value">0</span></div>
          <div class="w-full bg-slate-200"><div id="bar-formed" class="bar bg-green-600" style="width:0%"></div></div>
        </div>
      </div>
      <p id="deltaH" class="mt-2 font-semibold"></p>
    </div>

    <!-- Step 4 -->
    <div id="student-section" class="bg-white rounded-2xl shadow p-4 hidden">
      <h2 class="font-semibold mb-2">Step 4 — Student Calculation Pad</h2>
      <div class="grid md:grid-cols-3 gap-4">
        <div>
          <label class="text-xs text-slate-600">My ΣE Broken (kJ/mol)</label>
          <input id="input-broken" class="w-full border rounded px-2 py-1" />
        </div>
        <div>
          <label class="text-xs text-slate-600">My ΣE Formed (kJ/mol)</label>
          <input id="input-formed" class="w-full border rounded px-2 py-1" />
        </div>
        <div>
          <label class="text-xs text-slate-600">My ΔH</label>
          <input id="input-delta" class="w-full border rounded px-2 py-1" />
        </div>
      </div>
      <button id="check-btn" class="mt-4 bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Check My Work</button>
      <button id="ref-btn" class="mt-4 bg-slate-600 text-white px-4 py-2 rounded hover:bg-slate-700 ml-2">View Reference Energies</button>
      <p id="feedback" class="mt-3"></p>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" class="modal-bg hidden">
    <div class="bg-white rounded-2xl shadow-lg max-w-md w-full p-6 relative">
      <button id="close-modal" class="absolute top-2 right-3 text-xl font-bold text-slate-600">&times;</button>
      <h3 class="text-xl font-semibold mb-3 text-center">Common Bond Energies (kJ mol⁻¹)</h3>
      <table class="w-full text-sm text-left">
        <thead><tr><th>Bond</th><th>Energy</th></tr></thead>
        <tbody class="divide-y divide-slate-200">
          <tr><td>H–H</td><td>436</td></tr>
          <tr><td>Cl–Cl</td><td>243</td></tr>
          <tr><td>H–Cl</td><td>431</td></tr>
          <tr><td>O=O</td><td>498</td></tr>
          <tr><td>O–H</td><td>463</td></tr>
          <tr><td>C–H</td><td>413</td></tr>
          <tr><td>C–C</td><td>348</td></tr>
          <tr><td>C=C</td><td>614</td></tr>
          <tr><td>C=O</td><td>799</td></tr>
          <tr><td>C–O</td><td>358</td></tr>
          <tr><td>O–O</td><td>146</td></tr>
          <tr><td>N≡N</td><td>945</td></tr>
          <tr><td>N–H</td><td>391</td></tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    const reactions = {
      hcl: {
        name: "H₂ + Cl₂ → 2 HCl",
        reactants: [{ atoms:[{x:0,y:100,label:"H"}], bonds:[["H","H"]] }, { atoms:[{x:0,y:100,label:"Cl"}], bonds:[["Cl","Cl"]] }],
        products: [{ atoms:[{x:0,y:100,label:"H"}], bonds:[["H","Cl"]] }]
      },
      combustion: {
        name: "CH₄ + 2 O₂ → CO₂ + 2 H₂O",
        reactants: [{ atoms:[{x:0,y:100,label:"C"}], bonds:[["C","H"],["C","H"],["C","H"],["C","H"]] },
                   { atoms:[{x:0,y:100,label:"O"}], bonds:[["O","O"]] }],
        products: [{ atoms:[{x:0,y:100,label:"C"}], bonds:[["C","O"],["C","O"]] },
                   { atoms:[{x:0,y:100,label:"O"}], bonds:[["O","H"],["O","H"]] }]
      },
      haber: {
        name: "N₂ + 3 H₂ → 2 NH₃",
        reactants: [{ atoms:[{x:0,y:100,label:"N"}], bonds:[["N","N"]] },
                   { atoms:[{x:0,y:100,label:"H"}], bonds:[["H","H"]] }],
        products: [{ atoms:[{x:0,y:100,label:"N"}], bonds:[["N","H"],["N","H"],["N","H"]] }]
      },
      water_split: {
        name: "2 H₂O → 2 H₂ + O₂",
        reactants: [{ atoms:[{x:0,y:100,label:"O"}], bonds:[["O","H"],["O","H"]] }],
        products: [{ atoms:[{x:0,y:100,label:"H"}], bonds:[["H","H"]] },
                   { atoms:[{x:0,y:100,label:"O"}], bonds:[["O","O"]] }]
      },
      ethanol_combustion: {
        name: "C₂H₅OH + 3 O₂ → 2 CO₂ + 3 H₂O",
        reactants: [{ atoms:[{x:0,y:100,label:"C"}], bonds:[["C","C"],["C","H"],["C","H"],["C","H"]] },
                   { atoms:[{x:0,y:100,label:"O"}], bonds:[["O","O"]] }],
        products: [{ atoms:[{x:0,y:100,label:"C"}], bonds:[["C","O"],["C","O"]] },
                   { atoms:[{x:0,y:100,label:"O"}], bonds:[["O","H"],["O","H"]] }]
      }
    };

    const el = (t,a={}) => Object.assign(document.createElement(t),a);

    function drawReaction(reac){
      const svg = document.createElementNS("http://www.w3.org/2000/svg","svg");
      // Wider and taller drawing area
      svg.setAttribute("viewBox","0 0 1000 260");
      svg.setAttribute("width","100%");
      svg.setAttribute("height","260");

      const atomColors={H:"#ffffff",C:"#9ca3af",O:"#ef4444",N:"#3b82f6",Cl:"#22c55e"};

      // labels for rows
      const labelReact = document.createElementNS("http://www.w3.org/2000/svg","text");
      labelReact.setAttribute("x","20");
      labelReact.setAttribute("y","30");
      labelReact.setAttribute("fill","#0f172a");
      labelReact.setAttribute("font-size","16");
      labelReact.setAttribute("font-weight","600");
      labelReact.textContent = "Reactants";
      svg.append(labelReact);

      const labelProd = document.createElementNS("http://www.w3.org/2000/svg","text");
      labelProd.setAttribute("x","20");
      labelProd.setAttribute("y","145");
      labelProd.setAttribute("fill","#0f172a");
      labelProd.setAttribute("font-size","16");
      labelProd.setAttribute("font-weight","600");
      labelProd.textContent = "Products";
      svg.append(labelProd);

      // draw a molecule at a given column and row (reactant or product)
      function drawMol(mol,color,colIndex,isProduct=false){
        const centerX = 150 + colIndex*200;   // spacing left-right
        const centerY = isProduct ? 190 : 75; // top row vs bottom row
        const center = {x:centerX,y:centerY,label:mol.atoms[0].label};
        const r = 70; // distance for bonded atoms

        const angles=[0,120,240,60,180,300];
        let i=0;
        const placed=[center];

        mol.bonds.forEach(b=>{
          const base=center;
          const th=(angles[i++]*Math.PI)/180;
          const x=base.x+r*Math.cos(th), y=base.y+r*Math.sin(th);
          const a2={x,y,label:b[1]};
          placed.push(a2);
          const line=document.createElementNS("http://www.w3.org/2000/svg","line");
          line.setAttribute("x1",base.x); line.setAttribute("y1",base.y);
          line.setAttribute("x2",a2.x); line.setAttribute("y2",a2.y);
          line.setAttribute("stroke",color);
          line.setAttribute("stroke-width","4");
          svg.append(line);
        });

        placed.forEach(a=>{
          const c=document.createElementNS("http://www.w3.org/2000/svg","circle");
          c.setAttribute("cx",a.x); c.setAttribute("cy",a.y);
          c.setAttribute("r","22");
          c.setAttribute("fill",atomColors[a.label]||"#e5e7eb");
          c.setAttribute("stroke","#1f2937");
          c.setAttribute("stroke-width","2");
          svg.append(c);

          const t=document.createElementNS("http://www.w3.org/2000/svg","text");
          t.setAttribute("x",a.x-9);
          t.setAttribute("y",a.y+6);
          t.setAttribute("fill","#0f172a");
          t.setAttribute("font-size","18");
          t.setAttribute("font-weight","700");
          t.textContent=a.label;
          svg.append(t);
        });
      }

      // Reactants top row
      reac.reactants.forEach((m,idx)=> drawMol(m,"#2563eb",idx,false));
      // Products bottom row
      reac.products.forEach((m,idx)=> drawMol(m,"#16a34a",idx,true));

      const container = document.getElementById("svg-container");
      container.innerHTML="";
      container.append(svg);
    }

    function renderPresets(){
      const div=document.getElementById("preset-buttons");
      div.innerHTML="";
      Object.entries(reactions).forEach(([id,obj])=>{
        const btn=el("button",{
          className:"w-full text-left p-3 rounded-lg bg-slate-100 hover:bg-slate-200",
          textContent:obj.name
        });
        btn.onclick=()=>{
          document.getElementById("molecule-panel").classList.remove("hidden");
          drawReaction(obj);
        };
        div.append(btn);
      });
    }

    renderPresets();
  </script>
</body>
</html>
